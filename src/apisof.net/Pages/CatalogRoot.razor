@page "/catalog"

<div class="container-fluid px-0 mb-2">
    <nav class="p-2 bg-secondary-subtle" aria-label="breadcrumb">
        <ol class="my-0 breadcrumb">
            @if (BrowsingContext is FrameworkDiffBrowsingContext diffContext)
            {
                var left = diffContext.Left.GetShortFolderName();
                var right = diffContext.Right.GetShortFolderName();
                <li class="breadcrumb-item">
                    <a href="@Link.ForDiff()">@left vs @right</a>
                </li>
            }
            <li class="breadcrumb-item"><Glyph Kind="GlyphKind.Database" /> <a href="@Link.ForCatalog()">Catalog</a></li>
        </ol>
    </nav>
</div>

<div class="container-fluid ps-2">

    <ul class="list-unstyled">
        <li>
            <Glyph Kind="GlyphKind.Database" /> <span class="font-weight-bold">Catalog</span>

            <ul class="list-unstyled ps-4">
                @{
                    var items = CatalogService.Catalog.RootApis
                        .Order()
                        .Select(a => (Api: a, BrowsingData: BrowsingContext.GetData(a)))
                        .Where(a => !a.BrowsingData?.Excluded ?? true);
                }
                <ItemLimiter ItemSource="items" Limit="650">
                    @{
                        var child = context.Api;
                        var childData = context.BrowsingData;
                        var childCssClasses = childData?.CssClasses ?? string.Empty;
                        var childMarkup = childData?.AdditionalMarkup;
                        <li>
                            <Glyph Kind="@child.Kind.GetGlyph()"/> <a class="@childCssClasses" href="@Link.For(child)">@child.Name</a> @childMarkup
                        </li>
                    }
                </ItemLimiter>
            </ul>
        </li>
    </ul>
</div>
